#!/usr/bin/env bash
# Universal Claude-GLM Installer Bootstrap
# Detects OS and runs the appropriate installer

set -e

echo "üîç Detecting operating system..."
echo ""

# Detect OS
if [[ "$OSTYPE" == "msys"* ]] || [[ "$OSTYPE" == "cygwin"* ]] || [[ "$OSTYPE" == "win32" ]]; then
    echo "ü™ü Windows detected (Git Bash/MSYS)"
    echo ""
    echo "For the best experience on Windows, please use PowerShell instead:"
    echo ""
    echo "  iwr -useb https://raw.githubusercontent.com/windysky/claude-glm-wrapper/main/install.ps1 | iex"
    echo ""
    echo "Or download and run manually:"
    echo "  1. Download: https://raw.githubusercontent.com/windysky/claude-glm-wrapper/main/install.ps1"
    echo "  2. Run: .\\install.ps1"
    echo ""
    read -p "Continue with bash installation anyway? (y/n): " continue_choice
    if [[ "$continue_choice" != "y" && "$continue_choice" != "Y" ]]; then
        exit 0
    fi
    echo ""
    echo "Running bash installer..."
    exec bash "$(dirname "$0")/install.sh"

elif [[ "$OSTYPE" == "darwin"* ]]; then
    echo "üçé macOS detected"
    echo "Running Unix installer..."
    echo ""
    exec bash "$(dirname "$0")/install.sh"

elif [[ "$OSTYPE" == "linux-gnu"* ]] || [[ "$OSTYPE" == "linux"* ]]; then
    echo "üêß Linux detected"
    echo "Running Unix installer..."
    echo ""
    exec bash "$(dirname "$0")/install.sh"

else
    echo "‚ùì Unknown OS: $OSTYPE"
    echo ""
    echo "Attempting to run Unix installer..."
    echo ""
    exec bash "$(dirname "$0")/install.sh"
fi
